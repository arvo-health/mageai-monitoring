version: '3.8'

services:
  bigquery-emulator:
    image: ghcr.io/goccy/bigquery-emulator:latest
    container_name: mageai-monitoring-bigquery-emulator
    ports:
      - "9050:9050"  # REST API (used by Python client)
      - "9060:9060"  # gRPC
    environment:
      - PORT=9050
      - GRPC_PORT=9060
    command: ["--project", "test-project"]
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9050/"]
      interval: 5s
      timeout: 3s
      retries: 5
      start_period: 10s